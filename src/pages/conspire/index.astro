---
import Layout from '~/layouts/Layout.astro';
import Button from '~/components/Button.astro';
---

<Layout
	content={{
    title: 'Conspire Chat',
    description: "Web-based chat for radical exchange: ephemeral, anonymous, synchronous and free.",
  }}
  >
	<p>
		Instant rooms where voices and files move peer-to-peer, leaving no
		footprints. Built for privacy and digital autonomy, and against
		#chatcontrol
	</p>

  <h2>ğŸšªğŸƒ Choose a room</h2>
  <p class="subtitle">
    Join the public reception or create a private, ephemeral room. Rooms are anonymous and self-destruct when
    empty â€” share private room URLs only with trusted participants. Create your own <code>/room/$(NAME)</code> url or use the
    buttons below:
  </p>
  <div id="starter">
    <input type="button" value="Public Reception" onclick="startLobby();">
    <input type="button" value="New Private Room" onclick="startPrivateRoom();">
  </div>
  <div id="note">
    <section aria-labelledby="rules-heading">
      <h3 id="rules-heading">ğŸ“œ Rules</h3>

      <p>
        Conspire is an ephemeral, URL-based chat. Each room is identified by a unique URL â€” anyone with that
        URL can join.
        Long random URLs are private rooms, share them only with trusted participants.
      </p>

      <ul>
        <li><strong>Ephemeral rooms:</strong> Rooms are created when the first participant joins and are
          deleted automatically when the last participant leaves. No room data survives after deletion.
        </li>
        <li><strong>Access control:</strong> Possession of the room URL grants access. Treat URLs like keys
          and avoid posting them publicly.</li>
        <li><strong>History limits:</strong> Chat history is available to newly joined participants but is
          limited to 100 previous messages and is removed when the room is deleted. No data is stored
          permanently on our server.</li>
      </ul>
    </section>

    <section aria-labelledby="files-heading">
      <h3 id="files-heading">ğŸ’¾ File sharing</h3>

      <p>
        Share one or multiple files directly with other participants. Files are streamed peer-to-peer from
        the host's browser to recipients â€” the server does not receive, inspect, or store file contents.
      </p>

      <ul>
        <li><strong>How it works:</strong> The host announces a file, peers request chunks, and data is
          streamed in small pieces to avoid large memory spikes.</li>
        <li><strong>Availability:</strong> Files remain accessible only while the host keeps sharing. If the
          host cancels sharing or leaves the room, the files become unavailable.</li>
        <li><strong>Browser behavior:</strong> Your browser will prompt you to pick files to share and to
          save incoming files. Sizes and speeds depend on network conditions and peer bandwidth.</li>
      </ul>

      <p>
        Safety tip: only accept files from people you trust and verify file names and sizes before opening
        downloads.
      </p>
    </section>
  </div>

</div>

<script>
  function uuidv4() {
  return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, c =>
  (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)
  );
  }

  function startLobby() {
  window.open('/room/reception', '_blank');
  }

  function startPrivateRoom() {
  window.open('/room/' + uuidv4(), '_blank');
  }
</script>
<h3>ğŸƒ Sourcecode</h3>
<p>
Conspire is 100% free and open source software running as a single binary, written in C++ and based on the Oat++ framework. Its source-code is a fork of the "can-chat" example in Oat++ and is available on <a href="https://github.com/dyne/conspire">git dyne/conspire</a>.<br/>
May the source be always with you!
</p>
<p>&nbsp;</p>
</Layout>

